<PaymentTypeDropDown>:
    on_select:
        app.root.ids.payment_screen.ids.payment_type.text = '{}'.format(args[1])  

<PaymentModeDropDown>:
    on_select:
        app.root.ids.payment_screen.ids.mode_of_payment.text = '{}'.format(args[1])  

<PaymentGrid@GridLayout>:
	size_hint: 1.2,1.2
	size_hint_y: 0.6
	cols:5
	CustomGridButton:
		text: root.transaction_ref  or ""
	    on_press: root.line_click()
	CustomGridButton:
		text: root.card_four_digits or ""
	CustomGridButton:
		text: root.amount or ""
	CustomGridButton:
		text: root.payment_type or ""
	CustomGridButton:
		text: root.mode_of_payment or ""

<PaymentList>
	pay: pay
	canvas:
		Color:
		    rgba: (1,1,1,1) 
		Rectangle:
		    pos: self.pos
		    size: self.size
	CustomBoxLayout:
		padding: 20
		orientation: "vertical"
		BoxLayout:
			orientation: "vertical"
			BoxLayout:
				spacing: 5
				size_hint_y: 0.06
				CustomListTitle:
					text: "Payment"
					
				CustomListButton:
					text: "Back"
					on_press:
						root.manager.current= 'main_page'
						root.manager.transition = SlideTransition(direction="right")
				CustomListButton:
					text: "Add New"
					on_press: 
						root.make_current_click_idx_null()
						root.manager.current= 'payment'
						root.manager.transition = SlideTransition(direction="left")
					
			BoxLayout:
				size_hint_y: 0.1
				CustomListLabel:
					text: "Transaction Reference"				
				CustomListLabel:
					text: "Card Four Digit"
				CustomListLabel:
					text: "Amount"
				CustomListLabel:
					text: "Payment Type"
				CustomListLabel:
					text: "Mode od Payment"
					
			CustomListBoxLayout:
				RecycleView:
					scroll_type:['bars', 'content']
					bar_width: 10
					bar_color: (0,0,0,0.2)
					canvas.after:
				        Color:
				            rgba: self.bar_color[:3] + [self.bar_color[3] * 1 if self.do_scroll_y else 0]
				        Rectangle:
				            pos: self.right - self.bar_width - self.bar_margin, self.y + self.height * self.vbar[0]
				            size: self.bar_width, self.height * self.vbar[1]
					id: pay
					viewclass: 'PaymentGrid'
					CustomListRecycleGridLayout:

<CustomPaymentDateTimeLabel@Label>:
	size_hint_y: 3.5
	size_hint_x: 0.2
    font_size: 20
    text_size: self.size
    bold: True
    color: 0,0,0,1

<CustomPaymentLabel@Label>:
	size_hint_y: 0.35
    font_size: 20
    text_size: self.size
    bold: True
    color: 0,0,0,1

<CustomePaymentButton@Button>:
	canvas:
        Color:
            rgba: 0, 0, 0, 0.8
        Line:
            width: 1
            rectangle: self.x, self.y, self.width, self.height
	background_color: 0, 0, 0, 0.1
	color: 0,0,0,1
    text: 'Select'
    size_hint_y: None
    height: 40

<Payment>:
	transaction_ref: transaction_ref
	payment_type: payment_type
	mode_of_payment: mode_of_payment
	card_four_digits: card_four_digits
	amount: amount
	canvas:
		Color:
		    rgba: (1,1,1,1) 
		Rectangle:
		    pos: self.pos
		    size: self.size
	CustomBoxLayout:
		orientation: "horizontal"
		padding: 20
		spacing: 20
		BoxLayout:
			orientation: "vertical"
		    BoxLayout:
				size_hint_y: 0.05
				CustomBackButton:
					size_hint_x: 0.15
					size_hint_y: 1.5
					bold: True
					on_press: 
						app.root.ids.payment_list_screen.make_current_click_idx_null()
						root.manager.current= 'payment_list'	
						root.manager.transition = SlideTransition(direction="right")
				Label:
			BoxLayout:
				size_hint_y: 0.03
			CustomLineBoxLayout: 
				orientation: "vertical"
				BoxLayout:
					padding: 20
					size_hint_y: 0.14
				    Label:
						size_hint_y: 3
						size_hint_x: 0.2
				        font_size: 30
				        text: "Payment"
				        text_size: self.size
				        bold: True
				        italic: True
				        color: 0,0,0,1
				BoxLayout:
					padding: 20
					orientation: "vertical"
				    BoxLayout:
				    	size_hint_y: 0.1
						CustomPaymentDateTimeLabel:
					        text: "Date:"
					    DatePicker:					
							pHint: 0.2,0.3
							font_size: 15
							text_size: self.size
							size_hint_y: 4.1
							size_hint_x: 0.20
					    	id: p_date
					    BoxLayout:
					    	size_hint_x: 0.4
					    CustomPaymentDateTimeLabel:
					        text: "Time:"
					    CustomPaymentDateTimeLabel:
					        text: root.p_time or ""
					        id: p_time
					    BoxLayout:
					    	size_hint_x: 0.4
					BoxLayout:
						CustomPaymentLabel:
							size_hint_x: 0.2
					        text: "Trasaction Ref."
					    TextInput:
					    	size_hint_y: 0.60
					    	size_hint_x: 0.2
					    	font_size: 20
					    	id: transaction_ref
					    	write_tab: False

					BoxLayout:
						CustomPaymentLabel:
							size_hint_x: 1
					        text: "Payment Type"
					    CustomePaymentButton:
					        id: payment_type
					        on_release: Factory.PaymentTypeDropDown(root).open(self)
					        text_size: self.size
					        padding_x: 10
							valign: "middle"

					BoxLayout:
						CustomPaymentLabel:
							size_hint_x: 1
					        text: "Mode Of Payment"
					    CustomePaymentButton:
					        id: mode_of_payment
					        text: 'Select'
					        on_release: Factory.PaymentModeDropDown(root).open(self)
					        text_size: self.size
					        padding_x: 10
							valign: "middle"
					    
					BoxLayout:
						CustomPaymentLabel:
							size_hint_x: 0.2
					        text: "Card Four Digits"
					    TextInput:
					    	size_hint_y: 0.60
					    	size_hint_x: 0.2
					    	font_size: 20
					    	id: card_four_digits
					    	write_tab: False
					BoxLayout:
						CustomPaymentLabel:
							size_hint_x: 0.2
					        text: "Amount"
					    TextInput:
					    	size_hint_y: 0.60
					    	size_hint_x: 0.2
					    	font_size: 20
					    	id: amount
					    	write_tab: False
					BoxLayout:
						size_hint_y: 0.4
					BoxLayout:
						size_hint_y: 1
						BoxLayout:
							size_hint_x: 0.5
						BoxLayout:
							CustomSaveButton:
			            		size_hint_y: 0.7
			            		on_press: root.save()

			            	BoxLayout:
			            	CustomCancelButton:
			            		size_hint_y: 0.7
			            		on_press: root.cancel()
			            BoxLayout:
			            	size_hint_x: 0.5

	        BoxLayout:
				orientation: "vertical"
				size_hint_y: 0.3
        BoxLayout:
        	size_hint_x: 0.5

<SalePaymentPopup>:
	BoxLayout:
		canvas:
			Color:
			    rgba: (1,1,1,1) 
			Rectangle:
			    pos: self.pos
			    size: self.size
		CustomBoxLayout:
			orientation: "horizontal"
			padding: 20
			spacing: 20
			BoxLayout:
				orientation: "vertical"
			    BoxLayout:
					size_hint_y: 0.05
					CustomBackButton:
						size_hint_x: 0.15
						size_hint_y: 1.4
						bold: True	
						on_press: root.dismiss()
					Label:
				BoxLayout:
					size_hint_y: 0.03
				CustomLineBoxLayout: 
					orientation: "vertical"
					
					BoxLayout:
						padding: 20
						orientation: "vertical"
					    BoxLayout:
					    	size_hint_y: 0.1
							CustomPaymentDateTimeLabel:
						        text: "Date:"
						        size_hint_x: 0.10
						    DatePicker:		
								pHint: 0.2,0.3
								font_size: 15
								text_size: self.size
								size_hint_y: 4
								size_hint_x: 0.15
						    	id: p_date
						    BoxLayout:
								size_hint_x: 0.20
						    CustomPaymentDateTimeLabel:
						        text: "Time"
						        size_hint_x: 0.10
						    CustomPaymentDateTimeLabel:
						    	id: p_time
						        text: root.p_time or ""
						        size_hint_x: 0.15
						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Trasaction Ref."
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: transaction_ref
						    	write_tab: False
						    	multiline: False

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 1
						        text: "Payment Type"
						    CustomePaymentButton:
						    	text: "Receive"
						        id: payment_type
						        on_release: Factory.SalePaymentTypeDropDown(root).open(self)
						        text_size: self.size
						        padding_x: 10
								valign: "middle"

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 1
						        text: "Mode Of Payment"
						    CustomePaymentButton:
						        id: mode_of_payment
						        text: "Cash"
						        on_release: Factory.SalePaymentModeDropDown(root).open(self)
						    	text_size: self.size
						        padding_x: 10
								valign: "middle"
						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Card Four Digits"
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: card_four_digits
						    	text: str(root.card_four_digits or "")
						    	on_text_validate:
						    		root.card_four_digits = int(self.text)
						    	input_filter: 'int'
						    	write_tab: False
						    	multiline: False

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Amount"
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: amount
						    	input_filter: 'float'
						    	write_tab: False
						    	multiline: False
				    			on_text_validate: root.save()
						BoxLayout:
							size_hint_y: 0.4
						BoxLayout:
							size_hint_y: 1
							BoxLayout:
								size_hint_x: 0.2
							BoxLayout:
								CustomSaveButton:
				            		size_hint_y: 0.5
				            		on_press:  root.save()

				            	BoxLayout:
				            	CustomCancelButton:
				            		size_hint_y: 0.5
				            		on_press: root.cancel()
				            BoxLayout:
				            	size_hint_x: 0.2

		    

<PurchasePaymentPopup>:
	BoxLayout:
		canvas:
			Color:
			    rgba: (1,1,1,1) 
			Rectangle:
			    pos: self.pos
			    size: self.size
		CustomBoxLayout:
			orientation: "horizontal"
			padding: 20
			spacing: 20
			BoxLayout:
				orientation: "vertical"
			    BoxLayout:
					size_hint_y: 0.05
					CustomBackButton:
						size_hint_x: 0.15
						size_hint_y: 1.4
						bold: True	
						on_press: root.dismiss()
					Label:
				BoxLayout:
					size_hint_y: 0.03
				CustomLineBoxLayout: 
					orientation: "vertical"
					
					BoxLayout:
						padding: 20
						orientation: "vertical"
					    BoxLayout:
					    	size_hint_y: 0.1
							CustomPaymentDateTimeLabel:
						        text: "Date:"
						        size_hint_x: 0.10
						    DatePicker:		
								pHint: 0.2,0.3
								font_size: 15
								text_size: self.size
								size_hint_y: 4
								size_hint_x: 0.15
						    	id: p_date
						    BoxLayout:
								size_hint_x: 0.20
						    CustomPaymentDateTimeLabel:
						        text: "Time:"
						        size_hint_x: 0.10
						    CustomPaymentDateTimeLabel:
						    	id: p_time
						        text: root.p_time or ""
						        size_hint_x: 0.15
						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Trasaction Ref."
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: transaction_ref
						    	write_tab: False
						    	multiline: False

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 1
						        text: "Payment Type"
						    CustomePaymentButton:
						    	text: "Pay"
						        id: payment_type
						        on_release: Factory.PurchasePaymentTypeDropDown(root).open(self)
						        text_size: self.size
						        padding_x: 10
								valign: "middle"

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 1
						        text: "Mode Of Payment"
						    CustomePaymentButton:
						        id: mode_of_payment
						        text: "Cash"
						        on_release: Factory.PurchasePaymentModeDropDown(root).open(self)
						    	text_size: self.size
						        padding_x: 10
								valign: "middle"
						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Card Four Digits"
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: card_four_digits
						    	text: str(root.card_four_digits or "")
						    	on_text_validate:
						    		root.card_four_digits = int(self.text)
						    	input_filter: 'int'
						    	write_tab: False
						    	multiline: False

						BoxLayout:
							CustomPaymentLabel:
								size_hint_x: 0.2
						        text: "Amount"
						    TextInput:
						    	size_hint_y: 0.55
						    	size_hint_x: 0.2
						    	font_size: 20
						    	id: amount
						    	input_filter: 'float'
						    	write_tab: False
						    	multiline: False
				    			on_text_validate: root.save()

						BoxLayout:
							size_hint_y: 0.4
						BoxLayout:
							size_hint_y: 1
							BoxLayout:
								size_hint_x: 0.2
							BoxLayout:
								CustomSaveButton:
				            		size_hint_y: 0.5
				            		on_press:  root.save()

				            	BoxLayout:
				            	CustomCancelButton:
				            		size_hint_y: 0.5
				            		on_press: root.cancel()
				            BoxLayout:
				            	size_hint_x: 0.2

		      
		
